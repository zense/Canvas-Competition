<html>

<body onload="canvas.setup()">
    <canvas id="canvasArea" style="position: absolute; left: 0; top: 0; z-index: 0; width:100%;height:100%"></canvas>
    <script src="./canvas.js"></script>
</body>

</html>
<script>

    // Declare all global variables here
    var p = false;
    var flag = 0;
    var frame = 0;
    
    var x_vel = -15;
    var y_vel = 12;
    
    var ball_x = 0;
    var ball_y = 300;
    
    var tempAI_y = 0;
    var determine = 0;
    
    var p2_x = 0;
    var p2_y = 0;
            
    // Function which will be called repeatedly 

    function player(x_pos,y_pos) {
            canvas.drawRectangle(x_pos,y_pos,35,150);
    }

    function StartClick(mouseX,mouseY) {
        if(mouseX>632 && mouseX<732 && mouseY>385 && mouseY<420)
            return 1;
        else
            return 0;
    }
    
    // Declare custom functions here    
    function ballUpdate(width,height,hitbox1_y,hitbox2_y)
    {
        if(ball_x>width-40)
             {
              if(ball_y>hitbox2_y && ball_y<hitbox2_y+150)
                  x_vel = x_vel * -1;
              else if(ball_x>width) {
                  flag++;
                  if(flag>35)
                      flag = 0;    
              }
             }
        if(ball_x < 40)
            if(ball_y>hitbox1_y && ball_y<hitbox1_y+150)
                x_vel = x_vel * -1;
            else if(ball_x<0) {
                flag++;
                if(flag>35)
                      flag = 0;
                    } 
        if(ball_y>height || ball_y < 0)
            y_vel = y_vel * -1;
        ball_x += x_vel;
        ball_y += y_vel;
    }
    
    function EnemyAI() {
        if(tempAI_y<=0)
            tempAI_y = 0;
        else if(tempAI_y+150>=canvas.height)
            tempAI_y = canvas.height-150;
        
        if(determine%2 == 0)  
            if(tempAI_y+(determine/4)*5<ball_y)
                tempAI_y += 12;
            else
                tempAI_y -= 12;
        else 
            tempAI_y = tempAI_y - 12;
        player(canvas.width-35,tempAI_y);
    }

    function EnemyMultiplayer() {
        player(p2_x,p2_y);
    }

    function menu() {
            canvas.drawText(canvas.width/2 - 300, canvas.height/2 - 50,"Normal Game", fontSize = 100);
            canvas.drawRectangle(canvas.width/2 - 50,canvas.height/20 + 350,100,35);
            
            //For hovering of mouse over the button
            if(StartClick(canvas.mouseX,canvas.mouseY))
            {
                canvas.setDrawMode("fill");
                canvas.setColor("yellow");
                canvas.drawRectangle(canvas.width/2 - 50,canvas.height/20 + 350,100,35);
                canvas.setColor("black");
            }
            else 
            {
                canvas.setDrawMode("fill");
                canvas.setColor("white");
                canvas.drawRectangle(canvas.width/2 - 50,canvas.height/20 + 350,100,35);
                canvas.setColor("black");
            }

            //For Clicking of the Start button
            if(StartClick(canvas.mouseDownX,canvas.mouseDownY))
            {
                canvas.setDrawMode("fill");
                canvas.setColor("green");
                canvas.drawRectangle(canvas.width/2 - 50,canvas.height/20 + 350,100,35);
                canvas.setColor("black");
                p = true;
            }   
            canvas.drawText(canvas.width/2 - 20,canvas.height/20 + 375,"Start", fontSize = 20);    
            canvas.mouseDownX = 0;
            canvas.mouseDownY = 0;
            canvas.setDrawMode("stroke");
            //canvas.drawText(20,20,p, fontSize = 20);
    }

    function main() {
        if(determine%2 == 0) {
            if(frame%75==0)
                {
                    determine = Math.floor((Math.random() * 10) + 1);
                    frame = 0;
                }
            }
        else
        {
            //canvas.drawText(100,200,frame, fontSize = 100);
            if(frame%20 == 0)
                 {
                     determine = Math.floor((Math.random() * 10) + 1);
                     frame = 0;
                 }
        }        
        if(flag == 0)
        {
            ball_x = canvas.width/2;
            ball_y = canvas.height/2;
            flag = 1;
            p2_x = canvas.width - 35
        }
        if(!p)
        {
            menu();
        }
        else
        {
            //player and ball
            canvas.clear();
            player(0,canvas.mouseY);
            canvas.drawCircle(ball_x,ball_y,10);
            ballUpdate(canvas.width,canvas.height,canvas.mouseY,tempAI_y);
            //EnemyMultiplayer();

            //enemy AI
            EnemyAI();
            canvas.drawText(100,100,determine, fontSize = 100);
            
             
        }
    frame++;
    }
    // Override functions here; 
    canvas.mainFunction = main;

    canvas.keyDownCallback = function(e) {
		//  Key number 38 is the up arrow, 40 is down arrow
		//  Simply Google these things
        if (e.which == 38) {
            p2_y -= 50;
            if(p2_y<0)
                p2_y = 0;
		} else if (e.which == 40) {
            p2_y += 50;
            if(p2_y>canvas.height)
                p2_y = canvas.height;
            }
	};

    var timeStep = 50;
    canvas.startMain(timeStep);


    
</script>



